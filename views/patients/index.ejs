<head>
  <title>Patients List</title>
</head>
<body>
  <%- include('../partials/_navbar.ejs') %>

  <h1>Patients List</h1>

  <% patients.forEach(patient => { %>
    <div>
      <p><strong>Name:</strong> <%= patient.name %></p>
      <p><strong>Age:</strong> <%= patient.age %></p>
      <p><strong>Gender:</strong> <%= patient.gender %></p>
      <p><strong>Department:</strong> <%= patient.department.name %></p>

      <% if (user && user.role === 'Admin') { %>
        <p><strong>CPR ID:</strong> <%= patient.cprId %></p>
        <p><strong>Urgency Level:</strong> <%= patient.urgencyLevel.level %></p>
        <p><strong>Created At:</strong> <%= patient.createdAt.toLocaleString() %></p>
        <p><strong>Updated At:</strong> <%= patient.updatedAt.toLocaleString() %></p>

        <a href="/patients/<%= patient._id %>">View Details</a> |
        <a href="/patients/<%= patient._id %>/edit">Edit</a> |
        <form action="/patients/<%= patient._id %>?_method=DELETE" method="POST" style="display:inline;">
          <button type="submit">Delete</button>
        </form>
      <% } else { %>
        <a href="/patients/<%= patient._id %>">View Details</a>
      <% } %>
    </div>
    <hr>
  <% }); %>
</body>
